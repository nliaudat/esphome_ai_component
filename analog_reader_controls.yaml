# Analog Reader Controls for Home Assistant
# Exposes analog_reader parameters for runtime configuration

switch:
  # Pause Analog Processing
  - platform: template
    name: "Pause Analog Processing"
    id: ${id_prefix}_pause_analog_processing
    icon: "mdi:pause"
    entity_category: config
    optimistic: true
    restore_mode: RESTORE_DEFAULT_OFF
    turn_on_action:
      - lambda: |-
          if (id(${id_prefix}_analog_reader) != nullptr) {
            id(${id_prefix}_analog_reader)->set_pause_processing(true);
          }
    turn_off_action:
      - lambda: |-
          if (id(${id_prefix}_analog_reader) != nullptr) {
            id(${id_prefix}_analog_reader)->set_pause_processing(false);
          }

  # Auto Contrast (Min-Max Normalization)
  - platform: template
    name: "Auto Contrast"
    id: ${id_prefix}_auto_contrast
    icon: "mdi:contrast-box"
    entity_category: config
    optimistic: true
    restore_mode: RESTORE_DEFAULT_OFF
    turn_on_action:
      - lambda: |-
          if (id(${id_prefix}_analog_reader) != nullptr) {
            id(${id_prefix}_analog_reader)->set_all_auto_contrast(true);
          }
    turn_off_action:
      - lambda: |-
          if (id(${id_prefix}_analog_reader) != nullptr) {
            id(${id_prefix}_analog_reader)->set_all_auto_contrast(false);
          }

number:
  # Update Interval
  - platform: template
    name: "Update Interval"
    id: ${id_prefix}_analog_update_interval
    icon: "mdi:timer"
    unit_of_measurement: "s"
    min_value: 1
    max_value: 3600
    step: 1
    initial_value: 60
    entity_category: config
    optimistic: true
    restore_value: true
    set_action:
      - lambda: |-
          if (id(${id_prefix}_analog_reader) != nullptr) {
            id(${id_prefix}_analog_reader)->set_update_interval((uint32_t)(x * 1000));
          }

  # Contrast Adjustment
  - platform: template
    name: "Contrast"
    id: ${id_prefix}_contrast
    icon: "mdi:contrast-circle"
    min_value: 0.1
    max_value: 5.0
    step: 0.1
    initial_value: 1.0
    entity_category: config
    optimistic: true
    restore_value: true
    set_action:
      - lambda: |-
          if (id(${id_prefix}_analog_reader) != nullptr) {
            id(${id_prefix}_analog_reader)->set_all_contrast(x);
          }
